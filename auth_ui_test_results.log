🧪 Global E2E Test Setup Starting...
🔍 Pre-check: Verifying TESTIDS import...
✅ TESTIDS imported successfully: 122 testids available
   Sample testids: homeCreateLeagueBtn, navCreateLeagueBtn, joinViaInviteBtn, createLeagueWizardName, createLeagueWizardSlots...
✅ Application accessible at: https://pifa-league.preview.emergentagent.com (Status: 200)
🔐 Creating authenticated storage states...
🔑 Authenticating commish@example.com...
🔐 Logging in user: commish@example.com (mode: test)
🧪 Test-only login for user: commish@example.com
✅ Test-only login successful: commish@example.com (User ID: e92d337d-41e1-4867-abb8-154aa3a6357a)
✅ commish@example.com authenticated successfully
💾 Storage state saved: test-results/commissioner-state.json
🔑 Authenticating alice@example.com...
🔐 Logging in user: alice@example.com (mode: test)
🧪 Test-only login for user: alice@example.com
✅ Test-only login successful: alice@example.com (User ID: 1d870e32-2668-4003-a477-ed01c0b73532)
✅ alice@example.com authenticated successfully
💾 Storage state saved: test-results/alice-state.json
🔑 Authenticating bob@example.com...
🔐 Logging in user: bob@example.com (mode: test)
🧪 Test-only login for user: bob@example.com
✅ Test-only login successful: bob@example.com (User ID: 219110d6-44db-481a-95f9-af0cf54d5467)
✅ bob@example.com authenticated successfully
💾 Storage state saved: test-results/bob-state.json
🎉 Global setup completed successfully!

Running 30 tests using 1 worker

✅ Login form renders correctly with all required testid elements
  ✓   1 [chromium] › tests/e2e/auth_ui.spec.ts:11:7 › Authentication UI Tests › Login page renders form with all required testid elements (1.8s)
  ✓   2 [chromium] › tests/e2e/auth_ui.spec.ts:43:7 › Authentication UI Tests › Submit button is disabled for invalid email (1.4s)
✅ Invalid email error properly displayed with role="alert" and form remains interactive
  ✓   3 [chromium] › tests/e2e/auth_ui.spec.ts:67:7 › Authentication UI Tests › Shows error for invalid email submission (2.0s)
Browser Console: Magic link response: {message: Magic link generated! (Development Mode - Check below), dev_magic_link: https://pifa-league.preview.emergentagent.com/aut…msifQ.7MDMOVrTURwWFeouusdzPQE5WVgprlDhBETUeOk8OqA}
Browser Console: Test mode: false
API Response: {
  message: [32m'Magic link generated! (Development Mode - Check below)'[39m,
  dev_magic_link: [32m'https://pifa-league.preview.emergentagent.com/auth/verify?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InBsYXl3cmlnaHQtdGVzdEBleGFtcGxlLmNvbSIsImV4cCI6MTc1OTEyMTQ4OSwidHlwZSI6Im1hZ2ljX2xpbmsifQ.7MDMOVrTURwWFeouusdzPQE5WVgprlDhBETUeOk8OqA'[39m
}
Dev magic link button found, clicking...
Browser Console: 🧪 CREATE-DIALOG: closed - dialog closed
Browser Console: 🧪 CREATE-DIALOG: closed - dialog closed
  ✓   4 [chromium] › tests/e2e/auth_ui.spec.ts:101:7 › Authentication UI Tests › Successfully submits valid email and shows success (1.7s)
  ✓   5 [chromium] › tests/e2e/auth_ui.spec.ts:145:7 › Authentication UI Tests › Back to Home navigation works (1.5s)
ℹ️ Loading state too fast to catch - checking aria-busy changed
Final aria-busy state: false
Response status: 200
  ✓   6 [chromium] › tests/e2e/auth_ui.spec.ts:155:7 › Authentication UI Tests › Form handles loading state correctly (1.4s)
  ✓   7 [chromium] › tests/e2e/auth_ui.spec.ts:200:7 › Authentication UI Tests › No dead ends - page always has navigation options (1.4s)
  ✓   8 [chromium] › tests/e2e/auth_ui.spec.ts:218:7 › Authentication UI Tests › Test mode disables animations (1.4s)
✅ Form submission completed successfully using testids
  ✓   9 [chromium] › tests/e2e/auth_ui.spec.ts:238:7 › Authentication UI Integration › Form submission works using only testids (1.7s)
🔐 Logging in user: ui-integration-test@example.com (mode: ui)
🖱️  UI login for user: ui-integration-test@example.com
✅ UI login successful: ui-integration-test@example.com
  ✓  10 [chromium] › tests/e2e/auth_ui.spec.ts:269:7 › Authentication UI Integration › Complete auth flow using UI login mode (2.7s)
🧪 Testing empty email error handling...
  ✘  11 [chromium] › tests/e2e/auth_ui.spec.ts:281:7 › Authentication UI Integration › Shows error for empty email with proper UX (16.5s)
🧪 Testing invalid email error handling...
  ✘  12 [chromium] › tests/e2e/auth_ui.spec.ts:302:7 › Authentication UI Integration › Shows error for invalid email format with concise message (16.6s)
🧪 Testing error clearing behavior...
  ✘  13 [chromium] › tests/e2e/auth_ui.spec.ts:348:7 › Authentication UI Integration › Error clears when user starts typing (16.6s)
🧪 Testing submit button states...
  ✘  14 [chromium] › tests/e2e/auth_ui.spec.ts:377:7 › Authentication UI Integration › Submit button states work correctly during loading (16.6s)
🧪 Testing error accessibility...
  ✘  15 [chromium] › tests/e2e/auth_ui.spec.ts:435:7 › Authentication UI Integration › Error display has proper accessibility attributes (16.6s)
✅ Login form renders correctly with all required testid elements
  ✓  16 [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:11:7 › Authentication UI Tests › Login page renders form with all required testid elements (2.1s)
  ✓  17 [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:43:7 › Authentication UI Tests › Submit button is disabled for invalid email (1.4s)
✅ Invalid email error properly displayed with role="alert" and form remains interactive
  ✓  18 [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:67:7 › Authentication UI Tests › Shows error for invalid email submission (1.9s)
Browser Console: Magic link response: {message: Magic link generated! (Development Mode - Check below), dev_magic_link: https://pifa-league.preview.emergentagent.com/aut…msifQ.fhAIxUoKWgeHv4FfomBZLEd_G6CoZEj_9FO--mGTyG4}
Browser Console: Test mode: false
API Response: {
  message: [32m'Magic link generated! (Development Mode - Check below)'[39m,
  dev_magic_link: [32m'https://pifa-league.preview.emergentagent.com/auth/verify?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InBsYXl3cmlnaHQtdGVzdEBleGFtcGxlLmNvbSIsImV4cCI6MTc1OTEyMTU5NCwidHlwZSI6Im1hZ2ljX2xpbmsifQ.fhAIxUoKWgeHv4FfomBZLEd_G6CoZEj_9FO--mGTyG4'[39m
}
Dev magic link button found, clicking...
Browser Console: 🧪 CREATE-DIALOG: closed - dialog closed
Browser Console: 🧪 CREATE-DIALOG: closed - dialog closed
  ✓  19 [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:101:7 › Authentication UI Tests › Successfully submits valid email and shows success (1.8s)
  ✓  20 [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:145:7 › Authentication UI Tests › Back to Home navigation works (1.6s)
ℹ️ Loading state too fast to catch - checking aria-busy changed
Final aria-busy state: false
Response status: 200
  ✓  21 [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:155:7 › Authentication UI Tests › Form handles loading state correctly (1.4s)
  ✓  22 [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:200:7 › Authentication UI Tests › No dead ends - page always has navigation options (1.6s)
  ✓  23 [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:218:7 › Authentication UI Tests › Test mode disables animations (1.6s)
✅ Form submission completed successfully using testids
  ✓  24 [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:238:7 › Authentication UI Integration › Form submission works using only testids (1.7s)
🔐 Logging in user: ui-integration-test@example.com (mode: ui)
🖱️  UI login for user: ui-integration-test@example.com
✅ UI login successful: ui-integration-test@example.com
  ✓  25 [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:269:7 › Authentication UI Integration › Complete auth flow using UI login mode (2.1s)
🧪 Testing empty email error handling...
  ✘  26 [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:281:7 › Authentication UI Integration › Shows error for empty email with proper UX (16.2s)
🧪 Testing invalid email error handling...
  ✘  27 [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:302:7 › Authentication UI Integration › Shows error for invalid email format with concise message (16.3s)
🧪 Testing error clearing behavior...
  ✘  28 [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:348:7 › Authentication UI Integration › Error clears when user starts typing (16.3s)
🧪 Testing submit button states...
  ✘  29 [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:377:7 › Authentication UI Integration › Submit button states work correctly during loading (16.3s)
🧪 Testing error accessibility...
  ✘  30 [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:435:7 › Authentication UI Integration › Error display has proper accessibility attributes (16.3s)
🧹 Global E2E Test Teardown Starting...
🎉 Global teardown completed!


  1) [chromium] › tests/e2e/auth_ui.spec.ts:281:7 › Authentication UI Integration › Shows error for empty email with proper UX 

    TimeoutError: locator.fill: Timeout 15000ms exceeded.
    Call log:
    [2m  - waiting for locator('[data-testid="auth-email-input"]')[22m


      287 |
      288 |     // Submit with empty email (form validation should prevent this, but test anyway)
    > 289 |     await emailInput.fill('');
          |                      ^
      290 |     await expect(submitBtn).toBeDisabled();
      291 |     
      292 |     // Add some text then clear it to test error behavior
        at /app/tests/e2e/auth_ui.spec.ts:289:22

    attachment #1: screenshot (image/png) ──────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-376ea--empty-email-with-proper-UX-chromium/test-failed-1.png
    ────────────────────────────────────────────────────────────────────────────────────────────────

    attachment #2: video (video/webm) ──────────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-376ea--empty-email-with-proper-UX-chromium/video.webm
    ────────────────────────────────────────────────────────────────────────────────────────────────

  2) [chromium] › tests/e2e/auth_ui.spec.ts:302:7 › Authentication UI Integration › Shows error for invalid email format with concise message 

    TimeoutError: locator.fill: Timeout 15000ms exceeded.
    Call log:
    [2m  - waiting for locator('[data-testid="auth-email-input"]')[22m


      308 |
      309 |     // Enter invalid email and try to submit
    > 310 |     await emailInput.fill('invalid-email-format');
          |                      ^
      311 |     
      312 |     // Button should be disabled for invalid email
      313 |     await expect(submitBtn).toBeDisabled();
        at /app/tests/e2e/auth_ui.spec.ts:310:22

    attachment #1: screenshot (image/png) ──────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-a211b-format-with-concise-message-chromium/test-failed-1.png
    ────────────────────────────────────────────────────────────────────────────────────────────────

    attachment #2: video (video/webm) ──────────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-a211b-format-with-concise-message-chromium/video.webm
    ────────────────────────────────────────────────────────────────────────────────────────────────

  3) [chromium] › tests/e2e/auth_ui.spec.ts:348:7 › Authentication UI Integration › Error clears when user starts typing 

    TimeoutError: locator.fill: Timeout 15000ms exceeded.
    Call log:
    [2m  - waiting for locator('[data-testid="auth-email-input"]')[22m


      354 |
      355 |     // Enter email that might trigger error
    > 356 |     await emailInput.fill('error-test@invaliddomain999.com');
          |                      ^
      357 |     await submitBtn.click();
      358 |     
      359 |     // Wait a moment for any potential error
        at /app/tests/e2e/auth_ui.spec.ts:356:22

    attachment #1: screenshot (image/png) ──────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-27043-ars-when-user-starts-typing-chromium/test-failed-1.png
    ────────────────────────────────────────────────────────────────────────────────────────────────

    attachment #2: video (video/webm) ──────────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-27043-ars-when-user-starts-typing-chromium/video.webm
    ────────────────────────────────────────────────────────────────────────────────────────────────

  4) [chromium] › tests/e2e/auth_ui.spec.ts:377:7 › Authentication UI Integration › Submit button states work correctly during loading 

    TimeoutError: locator.fill: Timeout 15000ms exceeded.
    Call log:
    [2m  - waiting for locator('[data-testid="auth-email-input"]')[22m


      383 |
      384 |     // Fill valid email
    > 385 |     await emailInput.fill('loading-test@example.com');
          |                      ^
      386 |     
      387 |     // Button should be enabled
      388 |     await expect(submitBtn).toBeEnabled();
        at /app/tests/e2e/auth_ui.spec.ts:385:22

    attachment #1: screenshot (image/png) ──────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-af8ce-rk-correctly-during-loading-chromium/test-failed-1.png
    ────────────────────────────────────────────────────────────────────────────────────────────────

    attachment #2: video (video/webm) ──────────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-af8ce-rk-correctly-during-loading-chromium/video.webm
    ────────────────────────────────────────────────────────────────────────────────────────────────

  5) [chromium] › tests/e2e/auth_ui.spec.ts:435:7 › Authentication UI Integration › Error display has proper accessibility attributes 

    TimeoutError: locator.fill: Timeout 15000ms exceeded.
    Call log:
    [2m  - waiting for locator('[data-testid="auth-email-input"]')[22m


      441 |
      442 |     // Try to trigger an error
    > 443 |     await emailInput.fill('accessibility-test@invaliddomain999.com');
          |                      ^
      444 |     await submitBtn.click();
      445 |     await page.waitForTimeout(2000);
      446 |
        at /app/tests/e2e/auth_ui.spec.ts:443:22

    attachment #1: screenshot (image/png) ──────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-c5087-er-accessibility-attributes-chromium/test-failed-1.png
    ────────────────────────────────────────────────────────────────────────────────────────────────

    attachment #2: video (video/webm) ──────────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-c5087-er-accessibility-attributes-chromium/video.webm
    ────────────────────────────────────────────────────────────────────────────────────────────────

  6) [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:281:7 › Authentication UI Integration › Shows error for empty email with proper UX 

    TimeoutError: locator.fill: Timeout 15000ms exceeded.
    Call log:
    [2m  - waiting for locator('[data-testid="auth-email-input"]')[22m


      287 |
      288 |     // Submit with empty email (form validation should prevent this, but test anyway)
    > 289 |     await emailInput.fill('');
          |                      ^
      290 |     await expect(submitBtn).toBeDisabled();
      291 |     
      292 |     // Add some text then clear it to test error behavior
        at /app/tests/e2e/auth_ui.spec.ts:289:22

    attachment #1: screenshot (image/png) ──────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-376ea--empty-email-with-proper-UX-Mobile-Chrome/test-failed-1.png
    ────────────────────────────────────────────────────────────────────────────────────────────────

    attachment #2: video (video/webm) ──────────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-376ea--empty-email-with-proper-UX-Mobile-Chrome/video.webm
    ────────────────────────────────────────────────────────────────────────────────────────────────

  7) [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:302:7 › Authentication UI Integration › Shows error for invalid email format with concise message 

    TimeoutError: locator.fill: Timeout 15000ms exceeded.
    Call log:
    [2m  - waiting for locator('[data-testid="auth-email-input"]')[22m


      308 |
      309 |     // Enter invalid email and try to submit
    > 310 |     await emailInput.fill('invalid-email-format');
          |                      ^
      311 |     
      312 |     // Button should be disabled for invalid email
      313 |     await expect(submitBtn).toBeDisabled();
        at /app/tests/e2e/auth_ui.spec.ts:310:22

    attachment #1: screenshot (image/png) ──────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-a211b-format-with-concise-message-Mobile-Chrome/test-failed-1.png
    ────────────────────────────────────────────────────────────────────────────────────────────────

    attachment #2: video (video/webm) ──────────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-a211b-format-with-concise-message-Mobile-Chrome/video.webm
    ────────────────────────────────────────────────────────────────────────────────────────────────

  8) [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:348:7 › Authentication UI Integration › Error clears when user starts typing 

    TimeoutError: locator.fill: Timeout 15000ms exceeded.
    Call log:
    [2m  - waiting for locator('[data-testid="auth-email-input"]')[22m


      354 |
      355 |     // Enter email that might trigger error
    > 356 |     await emailInput.fill('error-test@invaliddomain999.com');
          |                      ^
      357 |     await submitBtn.click();
      358 |     
      359 |     // Wait a moment for any potential error
        at /app/tests/e2e/auth_ui.spec.ts:356:22

    attachment #1: screenshot (image/png) ──────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-27043-ars-when-user-starts-typing-Mobile-Chrome/test-failed-1.png
    ────────────────────────────────────────────────────────────────────────────────────────────────

    attachment #2: video (video/webm) ──────────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-27043-ars-when-user-starts-typing-Mobile-Chrome/video.webm
    ────────────────────────────────────────────────────────────────────────────────────────────────

  9) [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:377:7 › Authentication UI Integration › Submit button states work correctly during loading 

    TimeoutError: locator.fill: Timeout 15000ms exceeded.
    Call log:
    [2m  - waiting for locator('[data-testid="auth-email-input"]')[22m


      383 |
      384 |     // Fill valid email
    > 385 |     await emailInput.fill('loading-test@example.com');
          |                      ^
      386 |     
      387 |     // Button should be enabled
      388 |     await expect(submitBtn).toBeEnabled();
        at /app/tests/e2e/auth_ui.spec.ts:385:22

    attachment #1: screenshot (image/png) ──────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-af8ce-rk-correctly-during-loading-Mobile-Chrome/test-failed-1.png
    ────────────────────────────────────────────────────────────────────────────────────────────────

    attachment #2: video (video/webm) ──────────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-af8ce-rk-correctly-during-loading-Mobile-Chrome/video.webm
    ────────────────────────────────────────────────────────────────────────────────────────────────

  10) [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:435:7 › Authentication UI Integration › Error display has proper accessibility attributes 

    TimeoutError: locator.fill: Timeout 15000ms exceeded.
    Call log:
    [2m  - waiting for locator('[data-testid="auth-email-input"]')[22m


      441 |
      442 |     // Try to trigger an error
    > 443 |     await emailInput.fill('accessibility-test@invaliddomain999.com');
          |                      ^
      444 |     await submitBtn.click();
      445 |     await page.waitForTimeout(2000);
      446 |
        at /app/tests/e2e/auth_ui.spec.ts:443:22

    attachment #1: screenshot (image/png) ──────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-c5087-er-accessibility-attributes-Mobile-Chrome/test-failed-1.png
    ────────────────────────────────────────────────────────────────────────────────────────────────

    attachment #2: video (video/webm) ──────────────────────────────────────────────────────────────
    test-results/e2e-auth_ui-Authentication-c5087-er-accessibility-attributes-Mobile-Chrome/video.webm
    ────────────────────────────────────────────────────────────────────────────────────────────────

  10 failed
    [chromium] › tests/e2e/auth_ui.spec.ts:281:7 › Authentication UI Integration › Shows error for empty email with proper UX 
    [chromium] › tests/e2e/auth_ui.spec.ts:302:7 › Authentication UI Integration › Shows error for invalid email format with concise message 
    [chromium] › tests/e2e/auth_ui.spec.ts:348:7 › Authentication UI Integration › Error clears when user starts typing 
    [chromium] › tests/e2e/auth_ui.spec.ts:377:7 › Authentication UI Integration › Submit button states work correctly during loading 
    [chromium] › tests/e2e/auth_ui.spec.ts:435:7 › Authentication UI Integration › Error display has proper accessibility attributes 
    [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:281:7 › Authentication UI Integration › Shows error for empty email with proper UX 
    [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:302:7 › Authentication UI Integration › Shows error for invalid email format with concise message 
    [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:348:7 › Authentication UI Integration › Error clears when user starts typing 
    [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:377:7 › Authentication UI Integration › Submit button states work correctly during loading 
    [Mobile Chrome] › tests/e2e/auth_ui.spec.ts:435:7 › Authentication UI Integration › Error display has proper accessibility attributes 
  20 passed (3.7m)

  Serving HTML report at http://localhost:34181. Press Ctrl+C to quit.
