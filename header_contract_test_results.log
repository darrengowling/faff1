🧪 Global E2E Test Setup Starting...
🔍 Pre-check: Verifying TESTIDS import...
✅ TESTIDS imported successfully: 122 testids available
   Sample testids: homeCreateLeagueBtn, navCreateLeagueBtn, joinViaInviteBtn, createLeagueWizardName, createLeagueWizardSlots...
✅ Application accessible at: https://pifa-league.preview.emergentagent.com (Status: 200)
🔐 Creating authenticated storage states...
🔑 Authenticating commish@example.com...
🔐 Logging in user: commish@example.com (mode: test)
🧪 Test-only login for user: commish@example.com
✅ Test-only login successful: commish@example.com (User ID: e92d337d-41e1-4867-abb8-154aa3a6357a)
✅ commish@example.com authenticated successfully
💾 Storage state saved: test-results/commissioner-state.json
🔑 Authenticating alice@example.com...
🔐 Logging in user: alice@example.com (mode: test)
🧪 Test-only login for user: alice@example.com
✅ Test-only login successful: alice@example.com (User ID: 1d870e32-2668-4003-a477-ed01c0b73532)
✅ alice@example.com authenticated successfully
💾 Storage state saved: test-results/alice-state.json
🔑 Authenticating bob@example.com...
🔐 Logging in user: bob@example.com (mode: test)
🧪 Test-only login for user: bob@example.com
✅ Test-only login successful: bob@example.com (User ID: 219110d6-44db-481a-95f9-af0cf54d5467)
✅ bob@example.com authenticated successfully
💾 Storage state saved: test-results/bob-state.json
🎉 Global setup completed successfully!

Running 10 tests using 1 worker

✅ Login Page: back-to-home-link exists
✅ Login Page: nav-mobile-drawer exists
  ✓   1 [chromium] › tests/e2e/header-contract.spec.ts:21:9 › Header Contract Tests › Login Page (/login) has required header testids (1.6s)
✅ Landing Page: back-to-home-link exists
✅ Landing Page: nav-mobile-drawer exists
  ✓   2 [chromium] › tests/e2e/header-contract.spec.ts:21:9 › Header Contract Tests › Landing Page (/) has required header testids (1.6s)
✅ App Dashboard: back-to-home-link exists
✅ App Dashboard: nav-mobile-drawer exists
  ✓   3 [chromium] › tests/e2e/header-contract.spec.ts:21:9 › Header Contract Tests › App Dashboard (/app) has required header testids (1.5s)
✅ Create League: back-to-home-link exists
✅ Create League: nav-mobile-drawer exists
  ✓   4 [chromium] › tests/e2e/header-contract.spec.ts:21:9 › Header Contract Tests › Create League (/app/leagues/new) has required header testids (1.6s)
✅ Login Page: Exactly 1 header found
✅ Landing Page: Exactly 1 header found
✅ App Dashboard: Exactly 1 header found
✅ Create League: Exactly 1 header found
  ✓   5 [chromium] › tests/e2e/header-contract.spec.ts:60:7 › Header Contract Tests › All routes have exactly one header element (4.1s)
✅ Login Page: back-to-home-link exists
✅ Login Page: nav-mobile-drawer exists
  ✘   6 [Mobile Chrome] › tests/e2e/header-contract.spec.ts:21:9 › Header Contract Tests › Login Page (/login) has required header testids (2.0s)
✅ Landing Page: back-to-home-link exists
✅ Landing Page: nav-mobile-drawer exists
  ✘   7 [Mobile Chrome] › tests/e2e/header-contract.spec.ts:21:9 › Header Contract Tests › Landing Page (/) has required header testids (2.2s)
✅ App Dashboard: back-to-home-link exists
✅ App Dashboard: nav-mobile-drawer exists
  ✘   8 [Mobile Chrome] › tests/e2e/header-contract.spec.ts:21:9 › Header Contract Tests › App Dashboard (/app) has required header testids (2.1s)
✅ Create League: back-to-home-link exists
✅ Create League: nav-mobile-drawer exists
  ✘   9 [Mobile Chrome] › tests/e2e/header-contract.spec.ts:21:9 › Header Contract Tests › Create League (/app/leagues/new) has required header testids (1.9s)
✅ Login Page: Exactly 1 header found
✅ Landing Page: Exactly 1 header found
✅ App Dashboard: Exactly 1 header found
✅ Create League: Exactly 1 header found
  ✓  10 [Mobile Chrome] › tests/e2e/header-contract.spec.ts:60:7 › Header Contract Tests › All routes have exactly one header element (4.0s)
🧹 Global E2E Test Teardown Starting...
🎉 Global teardown completed!


  1) [Mobile Chrome] › tests/e2e/header-contract.spec.ts:21:9 › Header Contract Tests › Login Page (/login) has required header testids 

    Error: expect.toHaveAttribute: Error: strict mode violation: locator('[data-testid="nav-mobile-drawer"]') resolved to 2 elements:
        1) <div data-count="7" role="navigation" data-state="open" id="mobile-navigation" data-testid="nav-mobile-drawer" aria-label="Mobile navigation menu" class="bg-theme-surface w-full max-w-sm min-h-full shadow-lg overflow-y-auto drawer-panel">…</div> aka getByLabel('Mobile navigation menu')
        2) <div data-count="7" class="sr-only" data-state="open" aria-hidden="true" data-testid="nav-mobile-drawer">Mobile drawer state: open</div> aka getByText('Mobile drawer state: open')

    Call log:
    [2m  - Expect "toHaveAttribute" with timeout 5000ms[22m
    [2m  - waiting for locator('[data-testid="nav-mobile-drawer"]')[22m


      51 |         
      52 |         // Mobile drawer should now be open
    > 53 |         await expect(mobileDrawer).toHaveAttribute('data-state', 'open');
         |                                    ^
      54 |         
      55 |         console.log(`✅ ${route.name}: nav-mobile-drawer toggles to open state`);
      56 |       }
        at /app/tests/e2e/header-contract.spec.ts:53:36

    attachment #1: screenshot (image/png) ──────────────────────────────────────────────────────────
    test-results/e2e-header-contract-Header-38dd9-has-required-header-testids-Mobile-Chrome/test-failed-1.png
    ────────────────────────────────────────────────────────────────────────────────────────────────

    attachment #2: video (video/webm) ──────────────────────────────────────────────────────────────
    test-results/e2e-header-contract-Header-38dd9-has-required-header-testids-Mobile-Chrome/video.webm
    ────────────────────────────────────────────────────────────────────────────────────────────────

    Error Context: test-results/e2e-header-contract-Header-38dd9-has-required-header-testids-Mobile-Chrome/error-context.md

  2) [Mobile Chrome] › tests/e2e/header-contract.spec.ts:21:9 › Header Contract Tests › Landing Page (/) has required header testids 

    Error: expect.toHaveAttribute: Error: strict mode violation: locator('[data-testid="nav-mobile-drawer"]') resolved to 2 elements:
        1) <div data-count="7" role="navigation" data-state="open" id="mobile-navigation" data-testid="nav-mobile-drawer" aria-label="Mobile navigation menu" class="bg-theme-surface w-full max-w-sm min-h-full shadow-lg overflow-y-auto drawer-panel">…</div> aka getByLabel('Mobile navigation menu')
        2) <div data-count="7" class="sr-only" data-state="open" aria-hidden="true" data-testid="nav-mobile-drawer">Mobile drawer state: open</div> aka getByText('Mobile drawer state: open')

    Call log:
    [2m  - Expect "toHaveAttribute" with timeout 5000ms[22m
    [2m  - waiting for locator('[data-testid="nav-mobile-drawer"]')[22m


      51 |         
      52 |         // Mobile drawer should now be open
    > 53 |         await expect(mobileDrawer).toHaveAttribute('data-state', 'open');
         |                                    ^
      54 |         
      55 |         console.log(`✅ ${route.name}: nav-mobile-drawer toggles to open state`);
      56 |       }
        at /app/tests/e2e/header-contract.spec.ts:53:36

    attachment #1: screenshot (image/png) ──────────────────────────────────────────────────────────
    test-results/e2e-header-contract-Header-3edc7-has-required-header-testids-Mobile-Chrome/test-failed-1.png
    ────────────────────────────────────────────────────────────────────────────────────────────────

    attachment #2: video (video/webm) ──────────────────────────────────────────────────────────────
    test-results/e2e-header-contract-Header-3edc7-has-required-header-testids-Mobile-Chrome/video.webm
    ────────────────────────────────────────────────────────────────────────────────────────────────

    Error Context: test-results/e2e-header-contract-Header-3edc7-has-required-header-testids-Mobile-Chrome/error-context.md

  3) [Mobile Chrome] › tests/e2e/header-contract.spec.ts:21:9 › Header Contract Tests › App Dashboard (/app) has required header testids 

    Error: expect.toHaveAttribute: Error: strict mode violation: locator('[data-testid="nav-mobile-drawer"]') resolved to 2 elements:
        1) <div data-count="7" role="navigation" data-state="open" id="mobile-navigation" data-testid="nav-mobile-drawer" aria-label="Mobile navigation menu" class="bg-theme-surface w-full max-w-sm min-h-full shadow-lg overflow-y-auto drawer-panel">…</div> aka getByLabel('Mobile navigation menu')
        2) <div data-count="7" class="sr-only" data-state="open" aria-hidden="true" data-testid="nav-mobile-drawer">Mobile drawer state: open</div> aka getByText('Mobile drawer state: open')

    Call log:
    [2m  - Expect "toHaveAttribute" with timeout 5000ms[22m
    [2m  - waiting for locator('[data-testid="nav-mobile-drawer"]')[22m


      51 |         
      52 |         // Mobile drawer should now be open
    > 53 |         await expect(mobileDrawer).toHaveAttribute('data-state', 'open');
         |                                    ^
      54 |         
      55 |         console.log(`✅ ${route.name}: nav-mobile-drawer toggles to open state`);
      56 |       }
        at /app/tests/e2e/header-contract.spec.ts:53:36

    attachment #1: screenshot (image/png) ──────────────────────────────────────────────────────────
    test-results/e2e-header-contract-Header-c93b8-has-required-header-testids-Mobile-Chrome/test-failed-1.png
    ────────────────────────────────────────────────────────────────────────────────────────────────

    attachment #2: video (video/webm) ──────────────────────────────────────────────────────────────
    test-results/e2e-header-contract-Header-c93b8-has-required-header-testids-Mobile-Chrome/video.webm
    ────────────────────────────────────────────────────────────────────────────────────────────────

    Error Context: test-results/e2e-header-contract-Header-c93b8-has-required-header-testids-Mobile-Chrome/error-context.md

  4) [Mobile Chrome] › tests/e2e/header-contract.spec.ts:21:9 › Header Contract Tests › Create League (/app/leagues/new) has required header testids 

    Error: expect.toHaveAttribute: Error: strict mode violation: locator('[data-testid="nav-mobile-drawer"]') resolved to 2 elements:
        1) <div data-count="7" role="navigation" data-state="open" id="mobile-navigation" data-testid="nav-mobile-drawer" aria-label="Mobile navigation menu" class="bg-theme-surface w-full max-w-sm min-h-full shadow-lg overflow-y-auto drawer-panel">…</div> aka getByLabel('Mobile navigation menu')
        2) <div data-count="7" class="sr-only" data-state="open" aria-hidden="true" data-testid="nav-mobile-drawer">Mobile drawer state: open</div> aka getByText('Mobile drawer state: open')

    Call log:
    [2m  - Expect "toHaveAttribute" with timeout 5000ms[22m
    [2m  - waiting for locator('[data-testid="nav-mobile-drawer"]')[22m


      51 |         
      52 |         // Mobile drawer should now be open
    > 53 |         await expect(mobileDrawer).toHaveAttribute('data-state', 'open');
         |                                    ^
      54 |         
      55 |         console.log(`✅ ${route.name}: nav-mobile-drawer toggles to open state`);
      56 |       }
        at /app/tests/e2e/header-contract.spec.ts:53:36

    attachment #1: screenshot (image/png) ──────────────────────────────────────────────────────────
    test-results/e2e-header-contract-Header-87c7b-has-required-header-testids-Mobile-Chrome/test-failed-1.png
    ────────────────────────────────────────────────────────────────────────────────────────────────

    attachment #2: video (video/webm) ──────────────────────────────────────────────────────────────
    test-results/e2e-header-contract-Header-87c7b-has-required-header-testids-Mobile-Chrome/video.webm
    ────────────────────────────────────────────────────────────────────────────────────────────────

    Error Context: test-results/e2e-header-contract-Header-87c7b-has-required-header-testids-Mobile-Chrome/error-context.md

  4 failed
    [Mobile Chrome] › tests/e2e/header-contract.spec.ts:21:9 › Header Contract Tests › Login Page (/login) has required header testids 
    [Mobile Chrome] › tests/e2e/header-contract.spec.ts:21:9 › Header Contract Tests › Landing Page (/) has required header testids 
    [Mobile Chrome] › tests/e2e/header-contract.spec.ts:21:9 › Header Contract Tests › App Dashboard (/app) has required header testids 
    [Mobile Chrome] › tests/e2e/header-contract.spec.ts:21:9 › Header Contract Tests › Create League (/app/leagues/new) has required header testids 
  6 passed (41.5s)

  Serving HTML report at http://localhost:37745. Press Ctrl+C to quit.
